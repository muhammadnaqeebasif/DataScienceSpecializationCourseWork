str(NEI)
str(SCC)
##Checking the summary of the data
summary(NEI)
summary(SCC)
##-----------------------------------------------------------------------------
##-----------Total emission per year in Baltimore City--------------------------
library(dplyr)
total_emissions_baltimore <- NEI %>% filter(fips == "24510") %>%
select(year,Emissions) %>%group_by(year) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##-----------------------------------------------------------------------------
###-------------------------Total Eimssion Plot---------------------------------
my_color <- colorRampPalette(c("red","green"))
p<-with(total_emissions_baltimore,barplot(height=total_emissions,names.arg = year,
xlab = "Year",ylab = "Total Emsissions per kilo tons",
main="Total Emissions Per year in United States",
ylim = c(0,8000),col = my_color(4))
)
with(total_emissions_baltimore,text(x = p, y = round(total_emissions,2),
label = round(total_emissions,2),
pos = 3, cex = 0.8, col = "black"))
dev.copy(png,"plot2.png")
dev.off()
#-------------------------------------------------------------------------------
##Have total emissions from PM2.5 decreased in the Baltimore City from 1999 to 2008?"
if((total_emissions_baltimore[total_emissions_baltimore$year==2008,]$total_emissions) <
(total_emissions_baltimore[total_emissions_baltimore$year==1999,]$total_emissions)){
bool_dec<-"Yes"
}else {
bool_dec<-"No"
}
cat("Have total emissions from PM2.5 decreased in the Baltimore City from 1999 to 2008?",
bool_dec)
#---------------------------------------------------------------------------------
my_color <- colorRampPalette(c("red","green"))
p<-with(total_emissions_baltimore,barplot(height=total_emissions,names.arg = year,
xlab = "Year",ylab = "Total Emsissions per kilo tons",
main="Total Emissions Per year in Baltimore CIty",
ylim = c(0,8000),col = my_color(4))
)
with(total_emissions_baltimore,text(x = p, y = round(total_emissions,2),
label = round(total_emissions,2),
pos = 3, cex = 0.8, col = "black"))
dev.copy(png,"plot2.png")
dev.off()
View(total_emissions_vehicles)
library(dplyr)
total_emissions_baltimore <- NEI %>% filter(fips == "24510") %>%
select(year,Emissions,type) %>%group_by(year,type) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##-----------------------------------------------------------------------------
###-------------------------Total Eimssion Plot---------------------------------
library(ggplot2)
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions))
g +facet_grid(type~.) + geom_bar() +
labs(title="Total Emissions per year in Baltimore City")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions))
g +facet_grid(type~.)
g +facet_grid(type~.) + geom_bar()
g +facet_grid(type~.) + geom_bar(stat = "identity")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,color=type)
g +facet_grid(type~.) + geom_bar(stat = "identity")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,color=type)
)
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,color=type))
g +facet_grid(type~.) + geom_bar(stat = "identity")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill = type), colour = "white", fontface = "bold")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill = type), colour = "white", fontface = "bold")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(colour = "white")
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label()
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill=type))
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill=type),color="white")
g +facet_grid(.~type) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill=type),color="white")
g +facet_grid(type.~) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill=type),color="white")
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill=type),color="white")
library(ggplot2)
g <- ggplot(data = total_emissions_baltimore,aes(year,total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill=type),color="white")
dev.copy(png,"plot3.png")
dev.off()
# In plot it can be seen that for Non-road, Non-point, On-road total emissions
# is decreased from 1999 to 2008 while for point type total emissions is increased
# first from 1999-2005 and then it is decreased in 2008 and becomes nearly equal to
# the value in 2008.
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions,label=round(total_emissions)))
g + geom_bar() +
labs(title="Total Emissions per year in United States for Coal Combustion")
coal_scc <- SCC %>% filter(grepl("Coal",EI.Sector)) %>% select(SCC)
total_emissions_coal <- NEI %>% filter(SCC %in% coal_scc$SCC) %>%
select(year,Emissions) %>%group_by(year) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##------------------------------------------------------------------------------
###------------Total Eimssion Plot for Coal Combustion--------------------------
library(ggplot2)
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions,label=round(total_emissions)))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")
library(ggplot2)
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions,label=round(total_emissions),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions/1000,label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions/1000,label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") + label(ylab="Total Emission in kilo tons")+
labs(title="Total Emissions per year in United States for Coal Combustion")
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions/1000,label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") + labs(ylab="Total Emission in kilo tons")+
labs(title="Total Emissions per year in United States for Coal Combustion")
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions/1000,label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") + labs(ylabel="Total Emission in kilo tons")+
labs(title="Total Emissions per year in United States for Coal Combustion")
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions/1000,label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")+
ylab("Total emissions in kilo tons")
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions/1000,label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")+
ylab("Total emissions in kilo tons")+
geom_label(aes(fill=year))
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions/1000,label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")+
ylab("Total emissions in kilo tons")+
geom_label(aes(fill=year),color="white")
g <- ggplot(data = total_emissions_coal,aes(year,total_emissions/1000,label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")+
ylab("Total emissions in kilo tons")+
geom_label(aes(fill=year),color="white")
dev.copy(png,"plot4.png")
dev.off()
g <- ggplot(data = total_emissions_vehicles,aes(year,total_emissions,fill=year))
g + geom_bar(stat = "identity")
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City for Vehicle")
total_emissions_baltimore <- NEI %>% filter(fips == "24510") %>%
select(year,Emissions,type) %>%group_by(year,type) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##-----------------------------------------------------------------------------
###-------------------------Total Eimssion Plot---------------------------------
library(ggplot2)
g <- ggplot(data = total_emissions_baltimore,aes(factor(year),total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+
geom_label(aes(fill=type),color="white")
g <- ggplot(data = total_emissions_baltimore,aes(factor(year),total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+xlab("year")
geom_label(aes(fill=type),color="white")
vehicles_scc <- SCC %>% filter(grepl("Vehicles",EI.Sector)) %>% select(SCC)
total_emissions_vehicles <- NEI %>% filter((SCC %in% vehicles_scc$SCC)&(fips == "24510")) %>%
select(year,Emissions) %>%group_by(year) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##------------------------------------------------------------------------------
###---------Total Eimssion Plot for Vehicle in Baltimore City-----------
library(ggplot2)
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,fill=year))
g + geom_bar(stat = "identity") + +xlab("year")+ylab("Total emissions in tons")+
labs(title="Total Emissions per year in Baltimore City for Vehicle")+
geom_label(aes(fill=year))
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,fill=year))
g + geom_bar(stat = "identity") +xlab("year")+ylab("Total emissions in tons")+
labs(title="Total Emissions per year in Baltimore City for Vehicle")+
geom_label(aes(fill=year))
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=year,label=total_emissions))
g + geom_bar(stat = "identity") +xlab("year")+ylab("Total emissions in tons")+
labs(title="Total Emissions per year in Baltimore City for Vehicle")+
geom_label(aes(fill=year))
library(ggplot2)
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=year,label=round(total_emissions,2)))
g + geom_bar(stat = "identity") +xlab("year")+ylab("Total emissions in tons")+
labs(title="Total Emissions per year in Baltimore City for Vehicle")+
geom_label(aes(fill=year))
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=year,label=round(total_emissions,2)))
g + geom_bar(stat = "identity") +xlab("year")+ylab("Total emissions in tons")+
labs(title="Total Emissions per year in Baltimore City for Vehicle")+
geom_label(aes(fill=year),color="white")
g <- ggplot(data = total_emissions_vehicles,aes(year,total_emissions,fill=year,
label=round(total_emissions/1000,2)))
g + facet_grid(.~fips)
g <- ggplot(data = total_emissions_vehicles,aes(year,total_emissions,fill=year,
label=round(total_emissions/1000,2)))
g <- ggplot(data = total_emissions_vehicles,aes(year,total_emissions,fill=factor(year),
label=round(total_emissions/1000,2)))
g + facet_grid(.~fips) + geom_bar()
vehicles_scc <- SCC %>% filter(grepl("Vehicles",EI.Sector)) %>% select(SCC)
total_emissions_vehicles <- NEI %>% filter((SCC %in% vehicles_scc$SCC)&
(fips == "24510" |fips=="06037")) %>%
select(year,Emissions,fips) %>%group_by(year,fips) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##------------------------------------------------------------------------------
###---------Total Eimssion Plot for Vehicle in Baltimore City and California----
library(ggplot2)
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=year,label=round(total_emissions,2)))
g + facet_grid(.~fips) + geom_bar()
vehicles_scc <- SCC %>% filter(grepl("Vehicles",EI.Sector)) %>% select(SCC)
total_emissions_vehicles <- NEI %>% filter((SCC %in% vehicles_scc$SCC)&
(fips == "24510" |fips=="06037")) %>%
select(year,Emissions,fips) %>%group_by(year,fips) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##------------------------------------------------------------------------------
###---------Total Eimssion Plot for Vehicle in Baltimore City and California----
library(ggplot2)
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=year,label=round(total_emissions,2)))
g + facet_grid(.~fips) + geom_bar(stat = "identity")
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=year,label=round(total_emissions,2)))
g + facet_grid(fips~.) + geom_bar(stat = "identity")
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=fips,label=round(total_emissions,2)))
g + facet_grid(fips~.) + geom_bar(stat = "identity")
labs(title="Total Emissions per year for Vehicle")+
xlab("year")+ylab("Total emissions in tons")
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=fips,label=round(total_emissions,2)))
g + facet_grid(fips~.) + geom_bar(stat = "identity")
labs(title="Total Emissions per year for Vehicle")+
xlab("year")+ylab("Total emissions in tons")+
scale_color_manual(labels = c("California", "Baltimore City"),
values = c("blue", "red"))
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=c("blue", "red"),label=round(total_emissions,2)))
g + facet_grid(fips~.) + geom_bar(stat = "identity")
labs(title="Total Emissions per year for Vehicle")+
xlab("year")+ylab("Total emissions in tons")+
scale_color_manual(labels = c("California", "Baltimore City"),
values = c("blue", "red"))
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=c("blue", "red"),label=round(total_emissions,2)))
g + facet_grid(fips~.) + geom_bar(stat = "identity")
labs(title="Total Emissions per year for Vehicle")+
xlab("year")+ylab("Total emissions in tons")+
scale_color_manual(labels = c("California", "Baltimore City"),
values = c("blue", "red"))
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=c("blue", "red"),label=round(total_emissions,2)))
g + facet_grid(fips~.) + geom_bar(stat = "identity")
vehicles_scc <- SCC %>% filter(grepl("Vehicles",EI.Sector)) %>% select(SCC)
total_emissions_vehicles <- NEI %>% filter((SCC %in% vehicles_scc$SCC)&
(fips == "24510" |fips=="06037")) %>%
select(year,Emissions,fips) %>%group_by(year,fips) %>%
summarise(total_emissions = sum(Emissions)) %>%
mutate(County=ifelse(fips=="24510","Baltimore City","California"))
total_emissions_vehicles
library(ggplot2)
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=County,label=round(total_emissions,2)))
g + facet_grid(fips~.) + geom_bar(stat = "identity")
labs(title="Total Emissions per year for Vehicle")+
xlab("year")+ylab("Total emissions in tons")
g + facet_grid(fips~.) + geom_bar(stat = "identity")+
labs(title="Total Emissions per year for Vehicle")+xlab("year")+
ylab("Total emissions in tons")
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=County,label=round(total_emissions,2)))
g + facet_grid(County~.) + geom_bar(stat = "identity")+
labs(title="Total Emissions per year for Vehicle")+xlab("year")+
ylab("Total emissions in tons")
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=County,label=round(total_emissions,2)))
g + facet_grid(County~.) + geom_bar(stat = "identity")+
labs(title="Total Emissions per year for Vehicle")+xlab("year")+
ylab("Total emissions in tons")+geom_label(aes(fill=County))
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=County,label=round(total_emissions,2)))
g + facet_grid(County~.) + geom_bar(stat = "identity")+
labs(title="Total Emissions per year for Vehicle")+xlab("year")+
ylab("Total emissions in tons")+geom_label(aes(fill=County),color="white")
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=County,label=round(total_emissions,2)))
g + facet_grid(County~.,scales="free") + geom_bar(stat = "identity")+
labs(title="Total Emissions per year for Vehicle")+xlab("year")+
ylab("Total emissions in tons")+geom_label(aes(fill=County),color="white")
##-------------------------------------------Project2---------------------------
##Plot1.R
##------------------------------Loading the data--------------------------------
# downloading the source file
download.file("https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip",
destfile = "./FNEI_data.zip")
#Unzipping the source file
unzip("./FNEI_data.zip")
#Loading the data
NEI <- readRDS("./summarySCC_PM25.rds")
SCC <- readRDS("./Source_Classification_Code.rds")
##------------------------------------------------------------------------------
##-------------------------------Checking the summary of the data---------------
#Checking the structure of the data
str(NEI)
str(SCC)
##Checking the summary of the data
summary(NEI)
summary(SCC)
##-----------------------------------------------------------------------------
##----------------------------Total emission per year--------------------------
library(dplyr)
total_emission_year <- NEI %>% select(year,Emissions) %>%group_by(year) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##-----------------------------------------------------------------------------
###-------------------------Total Eimssion Plot---------------------------------
my_color <- colorRampPalette(c("red","green"))
p<-with(total_emission_year,barplot(height=total_emissions/1000,names.arg = year,
xlab = "Year",ylab = "Total Emsissions per kilo tons",
main="Total Emissions Per year in United States",
ylim = c(0,8000),col = my_color(4))
)
text(x = p, y = round(total_emission_year$total_emissions/1000,2),
label = round(total_emission_year$total_emissions/1000,2),
pos = 3, cex = 0.8, col = "black")
with(total_emission_year,lines(year,total_emissions))
dev.copy(png,"plot1.png")
dev.off()
#-------------------------------------------------------------------------------
##Have total emissions from PM2.5 decreased in the United States from 1999 to 2008?"
if((total_emission_year[total_emission_year$year==2008,]$total_emissions) <
(total_emission_year[total_emission_year$year==1999,]$total_emissions)){
bool_dec<-"Yes"
}else {
bool_dec<-"No"
}
cat("Have total emissions from PM2.5 decreased in the United States from 1999 to 2008?",
bool_dec)
#---------------------------------------------------------------------------------
my_color <- colorRampPalette(c("red","green"))
p<-with(total_emission_year,barplot(height=total_emissions/1000,names.arg = year,
xlab = "Year",ylab = "Total Emsissions in kilo tons",
main="Total Emissions Per year in United States",
ylim = c(0,8000),col = my_color(4))
)
text(x = p, y = round(total_emission_year$total_emissions/1000,2),
label = round(total_emission_year$total_emissions/1000,2),
pos = 3, cex = 0.8, col = "black")
with(total_emission_year,lines(year,total_emissions))
dev.copy(png,"plot1.png")
dev.off()
library(dplyr)
total_emissions_baltimore <- NEI %>% filter(fips == "24510") %>%
select(year,Emissions) %>%group_by(year) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##-----------------------------------------------------------------------------
###-------------------------Total Eimssion Plot---------------------------------
my_color <- colorRampPalette(c("red","green"))
p<-with(total_emissions_baltimore,barplot(height=total_emissions,names.arg = year,
xlab = "Year",ylab = "Total Emsissions in kilo tons",
main="Total Emissions Per year in Baltimore CIty",
ylim = c(0,8000),col = my_color(4))
)
with(total_emissions_baltimore,text(x = p, y = round(total_emissions,2),
label = round(total_emissions,2),
pos = 3, cex = 0.8, col = "black"))
dev.copy(png,"plot2.png")
dev.off()
library(dplyr)
total_emissions_baltimore <- NEI %>% filter(fips == "24510") %>%
select(year,Emissions,type) %>%group_by(year,type) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##-----------------------------------------------------------------------------
###-------------------------Total Eimssion Plot---------------------------------
library(ggplot2)
g <- ggplot(data = total_emissions_baltimore,aes(factor(year),total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.) + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+xlab("year")+
ylab("Total emissions in tons")+geom_label(aes(fill=type),color="white")
g <- ggplot(data = total_emissions_baltimore,aes(factor(year),total_emissions,fill=type,
label=round(total_emissions,2)))
g +facet_grid(type~.,scales = "free") + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in Baltimore City")+xlab("year")+
ylab("Total emissions in tons")+geom_label(aes(fill=type),color="white")
dev.copy(png,"plot3.png")
dev.off()
library(ggplot2)
g <- ggplot(data = total_emissions_coal,aes(factor(year),total_emissions/1000,
label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")+
ylab("Total emissions in kilo tons")+xlab("year")+
geom_label(aes(fill=year),color="white")
dev.copy(png,"plot4.png")
dev.off()
library(ggplot2)
g <- ggplot(data = total_emissions_coal,aes(factor(year),total_emissions/1000,
label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")+
ylab("Total emissions in kilo tons")+xlab("year")+
geom_label(aes(fill=year),color="white")
library(dplyr)
coal_scc <- SCC %>% filter(grepl("Coal",EI.Sector)) %>% select(SCC)
total_emissions_coal <- NEI %>% filter(SCC %in% coal_scc$SCC) %>%
select(year,Emissions) %>%group_by(year) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##------------------------------------------------------------------------------
###------------Total Eimssion Plot for Coal Combustion--------------------------
library(ggplot2)
g <- ggplot(data = total_emissions_coal,aes(factor(year),total_emissions/1000,
label=round(total_emissions/1000,2),fill=year))
g + geom_bar(stat = "identity") +
labs(title="Total Emissions per year in United States for Coal Combustion")+
ylab("Total emissions in kilo tons")+xlab("year")+
geom_label(aes(fill=year),color="white")
dev.copy(png,"plot4.png")
dev.off()
library(dplyr)
vehicles_scc <- SCC %>% filter(grepl("Vehicles",EI.Sector)) %>% select(SCC)
total_emissions_vehicles <- NEI %>% filter((SCC %in% vehicles_scc$SCC)&(fips == "24510")) %>%
select(year,Emissions) %>%group_by(year) %>%
summarise(total_emissions = sum(Emissions))
##-----------------------------------------------------------------------------
##------------------------------------------------------------------------------
###---------Total Eimssion Plot for Vehicle in Baltimore City-----------
library(ggplot2)
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=year,label=round(total_emissions,2)))
g + geom_bar(stat = "identity") +xlab("year")+ylab("Total emissions in tons")+
labs(title="Total Emissions per year in Baltimore City for Vehicle")+
geom_label(aes(fill=year),color="white")
dev.copy(png,"plot5.png")
dev.off()
# In plot it can be seen that total emissions is decreased from 1999-2008 for
# motor vehicle sources in Baltimore City.
library(ggplot2)
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=year,label=round(total_emissions,2)))
g + geom_bar(stat = "identity") +xlab("year")+ylab("Total emissions in tons")+
labs(title="Total Emissions per year in Baltimore City for Vehicles")+
geom_label(aes(fill=year),color="white")
dev.copy(png,"plot5.png")
dev.off()
# In plot it can be seen that total emissions is decreased from 1999-2008 for
# motor vehicle sources in Baltimore City.
library(dplyr)
vehicles_scc <- SCC %>% filter(grepl("Vehicles",EI.Sector)) %>% select(SCC)
total_emissions_vehicles <- NEI %>% filter((SCC %in% vehicles_scc$SCC)&
(fips == "24510" |fips=="06037")) %>%
select(year,Emissions,fips) %>%group_by(year,fips) %>%
summarise(total_emissions = sum(Emissions)) %>%
mutate(County=ifelse(fips=="24510","Baltimore City","California"))
##-----------------------------------------------------------------------------
##------------------------------------------------------------------------------
###---------Total Eimssion Plot for Vehicle in Baltimore City and California----
library(ggplot2)
g <- ggplot(data = total_emissions_vehicles,aes(factor(year),total_emissions,
fill=County,label=round(total_emissions,2)))
g + facet_grid(County~.,scales="free") + geom_bar(stat = "identity")+
labs(title="Total Emissions per year for Vehicle")+xlab("year")+
ylab("Total emissions in tons")+geom_label(aes(fill=County),color="white")
dev.copy(png,"plot6.png")
dev.off()
