ols.ic <- fit$coef[1]
ols.slope <- fit$coef[2]
0
0
0
0
0
0
0
0
00
0
0
x <- c(0.18, -1.54, 0.42, 0.95)
w <- c(2, 1, 3, 1)
sum(w*x) /sum(w)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
data(mtcars)
head(mtcars)
lm(mpg~wt,mtcars)
correlation <- 0.4
1.5*0.4
x <- c(8.58, 10.46, 9.01, 9.64, 8.86)
scale(x)
x  <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
mean(x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
lm(y~x-1)
install.packages("caret")
library(caret)
alpha <- 0.05
mua <- 32
mu0 <- 30
n <- 16
sigma <- 4
z <- qnorm(1-alpha)
pnorm(mu0 + z*sigma/sqrt(n),mean=mu0,sd=sigma/sqrt(n),lower.tail = FALSE)
alpha <- 0.05
mua <- 32
mu0 <- 30
n <- 16
sigma <- 4
z <- qnorm(1-alpha)
pnorm(mu0 + z*sigma/sqrt(n),mean=mu0,sd=sigma/sqrt(n),lower.tail = FALSE)
pnorm(mu0 + z*sigma/sqrt(n),mean=mu0,sd=sigma/sqrt(n),lower.tail = FALSE)
pnorm(mu0 + z*sigma/sqrt(n),mean=mu0,sd=sigma/sqrt(n),lower.tail = FALSE)
mu0 + z*sigma/sqrt(n)
pnorm(mu0 + z*sigma/sqrt(n),mean=mua,sd=sigma/sqrt(n),lower.tail = FALSE)
pnorm(mu0 + z*sigma/sqrt(n),mean=mua,sd=sigma/sqrt(n),lower.tail = FALSE)
pnorm(mu0 + z*sigma/sqrt(n),mean=c(31,32),sd=sigma/sqrt(n),lower.tail = FALSE)
seq(1,2,0.1)
n <- c(8,16,32,64,128)
mua <- seq(30,36,0.5)
n <- c(8,16,32,64,128)
mua <- seq(30,36,0.5)
sigma <- 4/sqrt(n)
sigma
pnorm(mu0 + z*sigma/sqrt(n),mean=c(31,32),sd=sigma,lower.tail = FALSE)
pnorm(mu0 + z*sigma/sqrt(n),mean=mua,sd=sigma,lower.tail = FALSE)
?repeat
;
?rep
rep(mua,5)
rep(n,each=length(mua))
alpha <- 0.05
power_values < as.numeric()
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in 1:n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=rep(n,each=length(mua)))
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(8),mean=mua,
sd=sigma/sqrt(8),lower.tail = FALSE)
)
power_values
mua
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(8),mean=c(1,2),
sd=sigma/sqrt(8),lower.tail = FALSE)
)
power_values
pnorm(mu0+ z*sigma/sqrt(8),mean=c(1,2),sd=sigma/sqrt(8),lower.tail = FALSE)
pnorm(mu0+ z*sigma/sqrt(8),mean=mua,sd=sigma/sqrt(8),lower.tail = FALSE)
rep(n,each=length(mua))
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in 1:n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in 1:n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=rep(n,each=length(mua)))
power_df
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=rep(n,each=length(mua)))
g <- ggplot(data <- power_df,aes(x=mua,y=power,colour=n))
library(ggplot2)
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=rep(n,each=length(mua)))
g <- ggplot(data <- power_df,aes(x=mua,y=power,colour=n))
g + geom_line()
library(ggplot2)
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=rep(n,each=length(mua)))
g <- ggplot(data <- power_df,aes(x=mua,y=power,colour=factor(n)))
g + geom_line()
library(ggplot2)
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=factor(rep(n,each=length(mua))))
g <- ggplot(data <- power_df,aes(x=mua,y=power,colour=factor(n)))
g + geom_line()
library(ggplot2)
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.5)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=factor(rep(n,each=length(mua))))
g <- ggplot(data <- power_df,aes(x=mua,y=power,colour=factor(n)))
g + geom_line(size=1.5)
library(ggplot2)
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.1)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=factor(rep(n,each=length(mua))))
g <- ggplot(data <- power_df,aes(x=mua,y=power,colour=factor(n)))
g + geom_line(size=1.5)
library(ggplot2)
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.1)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=factor(rep(n,each=length(mua))))
g <- ggplot(data <- power_df,aes(x=mua,y=power,colour=n))
g + geom_line(size=1.5)
library(ggplot2)
alpha <- 0.05
power_values <- as.numeric()
mua <- seq(30,35,0.1)
mu0 <- 30
n <- c(8,16,32,64,128)
sigma <- 4
z <- qnorm(1-alpha)
for(i in n){
power_values <- c(power_values,pnorm(mu0+ z*sigma/sqrt(i),mean=mua,
sd=sigma/sqrt(i),lower.tail = FALSE)
)
}
power_df <- data.frame(power=power_values,mua=rep(mua,5),n=factor(rep(n,each=length(mua))))
g <- ggplot(data <- power_df,aes(x=mua,y=power,colour=n))
g + geom_line(size=1.5)
g + geom_line(size=1.5)
power.t.test(n=16,delta = 2/4,type = "one.sample",sd=1,alternative = "one.sided")$power
power.t.test(n=16,delta = 2,type = "one.sample",sd=4,alternative = "one.sided")$power
power.t.test(n=16,delta = 100,type = "one.sample",sd=200,alternative = "one.sided")$power
power.t.test(power=0.8,delta = 100,type = "one.sample",sd=200,alternative = "one.sided")$power
power.t.test(power=0.8,delta = 100,type = "one.sample",sd=200,alternative = "one.sided")$n
dat <- data.frame(Subject=1:5,BaseLine = c(140,138,150,148,135),
Week2 = c(132,135,151,146,130))
data
dat <- data.frame(Subject=1:5,BaseLine = c(140,138,150,148,135),
Week2 = c(132,135,151,146,130))
dat
dat <- data.frame(Subject=1:5,BaseLine = c(140,138,150,148,135),
Week2 = c(132,135,151,146,130))
t.test(dat$BaseLine,dat$Week2,paired = TRUE)
power.t.test(n=9,sd=30,power=0.05,type = "one.sample",alternative =
"one.sided")
power.t.test(n=9,sd=30,power=0.05,type = "one.sample",alternative =
"two.sided")
power.t.test(n=9,sd=30,power=0.95,type = "one.sample",alternative =
"two.sided")
1100 -41
data(sleep)
head(sleep)
g1 <- sleep$extra[1 : 10]; g2 <- sleep$extra[11 : 20]
difference <- g2 - g1
mn <- mean(difference); s <- sd(difference); n <- 10
## Calculating directly
mn + c(-1, 1) * qt(.975, n-1) * s / sqrt(n)
## using R's built in function
t.test(difference)
## using R's built in function, another format
t.test(g2, g1, paired = TRUE)
## using R's built in function, another format
t.test(extra ~ I(relevel(group, 2)), paired = TRUE, data = sleep)
(1100+c(-1,1)*qt(0.975)*30/sqrt(9))
(1100+c(-1,1)*qt(0.975,8)*30/sqrt(9))
data <- data.frame(person=1:4,pepsi=c(0,0,0,1),coke=(1,1,1,0))
data <- data.frame(person=1:4,pepsi=c(0,0,0,1),coke=c(1,1,1,0))
data
data <- data.frame(person=1:4,pepsi=c(0,0,0,1),coke=c(1,1,1,0))
t.test(data$pepsi,data$coke,paired = TRUE)
data <- data.frame(person=1:4,pepsi=c(0,0,0,1),coke=c(1,1,1,0))
t.test(data$pepsi,data$coke)
dat <- data.frame(Subject=1:5,BaseLine = c(140,138,150,148,135),
Week2 = c(132,135,151,146,130))
t.test(dat$BaseLine,dat$Week2,paired = TRUE)
n <- 4
x <-3
test <- binom.test(x=x,n=n,alternative = "greater")
n <- 4
x <-3
test <- binom.test(x=x,n=n,alternative = "greater")
test
rate <- 1/100
e <- 10
days <- 1787
poisson.test(errors,T=days,r=rate,alt="less")
rate <- 1/100
e <- 10
days <- 1787
poisson.test(e,T=days,r=rate,alt="less")
alpha <- 0.05
mua <- 32
mu0 <- 30
n <- 16
sigma <- 4
z <- qnorm(1-alpha)
pnorm(mu0 + z*sigma/sqrt(n),mean=mu0,sd=sigma/sqrt(n),lower.tail = FALSE)
pnorm(mu0 + z*sigma/sqrt(n),mean=mua,sd=sigma/sqrt(n),lower.tail = FALSE)
power.t.test(n=100,sd=0.04,delta = 0.01,alternative = "two.sided")
power.t.test(n=100,sd=0.04,delta = 0.01,alternative = "two.sided",sig.level = 0.10)
power.t.test(n=100,sd=0.04,delta = -0.01,alternative = "two.sided",sig.level = 0.05)
power.t.test(n=100,sd=0.04,delta = -0.01,alternative = "two.sided",sig.level = 0.05,type = "one.sample")
power.t.test(n=100,sd=0.04,delta = 0.01,alternative = "two.sided",sig.level = 0.05,type = "one.sample")
power.t.test(n=100,sd=0.04,delta = 0.01,alternative = "two.sided",sig.level = 0.05,type = "one.sided")
power.t.test(n=100,sd=0.04,delta = 0.01,alternative = "one.sided",sig.level = 0.05,type = "one.sample")
power.t.test(n=100,sd=0.04,delta = 0.01,alternative = "two.sided",sig.level = 0.10,type = "one.sample")
power.t.test(n=100,sd=0.04,delta = 0.01,alternative = "one.sided",sig.level = 0.05,type = "one.sample")
power.t.test(power = 0.90,sd=0.04,delta = 0.01,alternative = "one.sided",sig.level = 0.05,type = "one.sample")
μ <- 0.01# m^3 brain volume loss mean
σ <- 0.04# m^3 brain volume loss std. dev.
p <- 0.05 # sign level
pow <- 0.9 #power
n <- power.t.test(power=pow, delta=μ, sd=σ , sig.level=p, type="one.sample", alt="one.sided")$n
n
mux <- -3
n <- 9
sdx <- 1.5
muy <- 1
sdy <- 1.8
sdxy <- sqrt(((n-1)*sdx^2 +(n-1)*sdy^2)/(n+n-2))
q <- (mux -muy-0)/(sdxy * sqrt(1/n +1/n))
pt(q,df = n-1)
mux <- -3
n <- 9
sdx <- 1.5
muy <- 1
sdy <- 1.8
sdxy <- sqrt(((n-1)*sdx^2 +(n-1)*sdy^2)/(n+n-2))
q <- (mux -muy-0)/(sdxy * sqrt(1/n +1/n))
pt(q,df = 2*n-1)
n_y <- 9 # subjects treated
n_x <- 9 # subjects placebo
σ_y <- 1.5# kg/m2 std.dev. treated
σ_x <- 1.8# kg/m2 std.dev. placebo
μ_y <- -3#  kg/m2 average difference treated
μ_x <- 1#  kg/m2 average difference placebo
# calculate pooled standard deviation
σ_p <- (((n_x - 1) * σ_x^2 + (n_y - 1) * σ_y^2)/(n_x + n_y - 2))
σ_p
sdxy
sdxy^2
(μ_y - μ_x) / (σ_p * (1 / n_x + 1 / n_y)^.5
)
q
muy
mux <- -3
n <- 9
sdx <- 1.5
muy <- 1
sdy <- 1.8
sdxy <- sqrt(((n-1)*sdx^2 +(n-1)*sdy^2)/(n+n-2))
q <- (mux -muy-0)/(sdxy * sqrt(2/n ))
pt(q,df = 2*n-1)
q
muy - mux
μ_y - μ_x
mux - muy
(sdxy * sqrt(2/n )
)
(σ_p * (1 / n_x + 1 / n_y)^.5)
n_x
n_y
library(UsingR)
library(reshape)
library(ggplot2)
data(galton)
head(galton)
librarty(tidyr)
library(tidyr)
gather(galton,child,parent,key="variable",value="values")
long <-gather(galton,child,parent,key="variable",value="values")
tail(long)
library(manipulate)
myHist <- function(mu){
mse <- mean((galton$child - mu)^2)
g <- ggplot(galton, aes(x = child)) + geom_histogram(fill = "salmon", colour= "black", binwidth=1)
g <- g + geom_vline(xintercept = mu, size = 3)
g <- g + ggtitle(paste("mu = ", mu, ", MSE = ", round(mse, 2), sep = ""))
g
}
manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
ggplot(galton, aes(x = parent, y = child)) + geom_point()
library(dplyr)
freqData <- as.data.frame(table(galton$child, galton$parent))
names(freqData) <- c("child", "parent", "freq")
freqData$child <- as.numeric(as.character(freqData$child))
freqData$parent <- as.numeric(as.character(freqData$parent))
g <- ggplot(filter(freqData, freq > 0), aes(x = parent, y = child))
g <- g  + scale_size(range = c(2, 20), guide = "none" )
g <- g + geom_point(colour="grey50", aes(size = freq+20, show_guide = FALSE))
g <- g + geom_point(aes(colour=freq, size = freq))
g <- g + scale_colour_gradient(low = "lightblue", high="white")
g
freqData <- as.data.frame(table(galton$child, galton$parent))
names(freqData) <- c("child", "parent", "freq")
freqData$child <- as.numeric(as.character(freqData$child))
freqData$parent <- as.numeric(as.character(freqData$parent))
g <- ggplot(filter(freqData, freq > 0), aes(y = parent, x = child))
g <- g  + scale_size(range = c(2, 20), guide = "none" )
g <- g + geom_point(colour="grey50", aes(size = freq+20, show_guide = FALSE))
g <- g + geom_point(aes(colour=freq, size = freq))
g <- g + scale_colour_gradient(low = "lightblue", high="white")
g
freqData <- as.data.frame(table(galton$child, galton$parent))
names(freqData) <- c("child", "parent", "freq")
freqData$child <- as.numeric(as.character(freqData$child))
freqData$parent <- as.numeric(as.character(freqData$parent))
g <- ggplot(filter(freqData, freq > 0), aes(y = parent, x = child))
g <- g  + scale_size(range = c(2, 20), guide = "none" )
g <- g + geom_point(colour="grey50", aes(size = freq+20, show_guide = FALSE))
g <- g + geom_point(aes(colour=freq, size = freq))
g <- g + scale_colour_gradient(low = "lightblue", high="white")
g
library(UsingR)
data(galton)
library(dplyr)
freqData <- as.data.frame(table(galton$child,galton$parent))
names(freqData) <- c("child","parent","freq")
freqData$child <- as.numeric(as.character(freqData$child))
freqData$parent <- as.numeric(as.character(freqData$parent))
g <- ggplot(data=filter(freqData,freq>0),aes(parent,child))
g <- g +scale_size(range = c(2,20),guide="none")
g <- g + geom_point(colour="grey50",aes(size=freq+20))
g <- g + geom_point(aes(colour=freq,size = freq))
g <- g + scale_colour_gradient(low="lightblue",high = "white")
g <- g +geom_smooth(method = "lm")
g
library(UsingR)
library(reshape)
library(ggplot2)
data(galton)
long <- melt(galton)
g <- ggplot(long,aes(x=value,fill=variable))
g <- g +geom_histogram(colour="black",binwidth = 1)
g <- g +facet_grid(.~variable)
g
setwd("F:/Coursera/DataScienceSpecializationCoursera/7_Regression_models/Week2")
library(UsingR)
data(diamond)
library(ggplot2)
View(diamond)
View(diamond)
library(UsingR)
data(diamond)
library(ggplot2)
g <- ggplot(diamond,aes(x=carat,y=price))
g <- g +xlab("Mass (carats)")
g <- g + ylab("Price (SIN $)")
g <- g + geom_point(size=6,colour="black",alpha=0.2)
g <- g + geom_point(size=5,colour="blue",alpha=0.2)
g <- g + geom_smooth(method="lm",colour="black")
g
fit <- lm(price~carat,data = diamond)
coef(fit)
summary(fit)
fit2 <- lm(price~I(carat-mean(carat)),data=diamond)
coef(fit2)
newx <- c(0.16,0.27,0.34)
ceof(fit)[1] + coef(fit)[2]*newx
newx <- c(0.16,0.27,0.34)
ceof(fit)[1] + coef(fit)[2]*newx
coef(fit)[1] + coef(fit)[2]*newx
newx <- c(0.16,0.27,0.34)
coef(fit)[1] + coef(fit)[2]*newx
predict(fit,newdata=data.frame(carat=newx))
predict(fit)
fit
fit$residuals
sum(fit$residuals)
mean(fit$residuals)
data(diamond)
fit <- lm(price~carots,data=diamond)
data(diamond)
fit <- lm(price~carats,data=diamond)
data(diamond)
fit <- lm(price~carat,data=diamond)
e <- resid(fit)
e
