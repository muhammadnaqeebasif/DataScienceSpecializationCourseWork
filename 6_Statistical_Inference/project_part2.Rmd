---
title: "Statistical Inference Course Project Part2"
author: "Naqeeb Asif"
date: "14 February 2018"
output:
  pdf_document: default
  html_document: default
---

# Synopsis
This experiment explores the ToothGrowth data set. Exploratory analysis is first 
performed on the dataset. After the analysis the hypothesis test is performed
according to which "dose" is the most significant in predicting the "length".

# Loading the data
In this section "Tooth Growth" data is loaded.
```{r}
data("ToothGrowth")
head(ToothGrowth)
```

# Exploratoty analysis
In this section exploratory analysis is performed on the data

## Checking the structure of the data

```{r}
str(ToothGrowth)
```

## Checking the unique entries in feature 'dose'

```{r}
unique(ToothGrowth$dose)
```
As there are only three unique values in this feature so lets change the
calss of the this feature to factor.

```{r}
ToothGrowth$dose <- factor(ToothGrowth$dose)
```

## Boxplot of features
In this section boxplot is plotted between different features of the data.

### Boxplot between 'Suppliment type' and 'length'
In this section boxplot is plotted between length of tooth and supplement type.

```{r message=FALSE}
library(ggplot2)
g <- ggplot(data = ToothGrowth,aes(supp,len))
g + geom_boxplot(aes(fill=supp)) +
  labs(title="Suppliment Type Vs Length")+
  theme(plot.title = element_text(hjust = 0.5))+
  xlab("Suppliment Type")+ylab("Length")
```
```{r message=FALSE}
library(ggplot2)
g <- ggplot(data = ToothGrowth,aes(supp,len))
g + geom_boxplot(aes(fill=supp)) +facet_grid(.~dose)+
  labs(title="Suppliment Type Vs Length")+
  theme(plot.title = element_text(hjust = 0.5))+
  xlab("Suppliment Type")+ylab("Length")
```

### Boxplot between Dose and length
In this section boxplot is plotted between length of tooth and dose.

```{r message=FALSE}
library(ggplot2)
g <- ggplot(data = ToothGrowth,aes(dose,len))
g + geom_boxplot(aes(fill=dose))+
  labs(title="Dose Vs Length")+
  theme(plot.title = element_text(hjust = 0.5))+
  xlab("Dose (mg/day)")+ylab("Length")
```

```{r message=FALSE}
library(ggplot2)
g <- ggplot(data = ToothGrowth,aes(dose,len))
g + geom_boxplot(aes(fill=dose)) + facet_grid(.~supp)+
  xlab("Dose (mg/day)")+ylab("Length")
```

## Results

As it can be seen from the plots that length depends upon the dose and 
suppliment. Each supllement type has different mean according to its type.
Same is the case with different doeses.

# Summary
In this section summary of the data set is presented.
```{r}

md <-lm(len ~dose,data = ToothGrowth)
summary(md)
```

# Hypothesis Tests
In this section hyothesis test is performed on the data set.

## Test on length and suppliment type
In this section hypothesis test on length and suppliment type is performed.
```{r}
t.test(len~supp,data = ToothGrowth)
```
As it can be seen that p-value is smaller than 0.05 therefore the feature "Suppliment Type" is less significant.

## Test on length and dose
In this section hypothesis test on length and dose is performed. As hypothesis test
can be performed on the data with two groups or levels and 'dose' has three levels
therefore the test is performed by subsetting the 'dose' in two levels.

1. Tesing for dose equals to 0.5 or 1
```{r,message=FALSE}
library(data.table)
library(dplyr)
ToothGrowth <- data.table(ToothGrowth)
t.test(len~dose,data=filter(ToothGrowth,dose %in% c(0.5,1)))
```

2. Testing for dose equals to 1 or 2

```{r,message=FALSE}
library(data.table)
library(dplyr)
ToothGrowth <- data.table(ToothGrowth)
t.test(len~dose,data=filter(ToothGrowth,dose %in% c(2,1)))
```

3. Testing for dose equals to 0.5 or 2

```{r,message=FALSE}
library(data.table)
library(dplyr)
ToothGrowth <- data.table(ToothGrowth)
t.test(len~dose,data=filter(ToothGrowth,dose %in% c(0.5,2)))
```


AS it can be seen from the above results that p-value is less than 0.05 
therefore feature "dose" is most significant in predicting the length of
tooth.

# Conclusion
We can conclude from the above results that length in the toothgrowth 
dataset depends on the supplement type and dose of the vitamin. But dose is
the most significant feature in predicting the length whereas the feature 
supplement type is less significant in prediction because its p-value for
supplement type is slightly less than 0.05.
